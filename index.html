<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Player</title>
	<link rel="stylesheet" type="text/css" href="./bower_components/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="./css/style.css">
</head>
<body>
<!-- Player GUI -->
<div id="player-gui">
	<div id="meta-information"></div>
	<div id="player-controls">
		<span id="play"><i class="icon fa fa-play"></i></span> <span id="time-elapsed">00:00</span> / <span id="duration">00:00</span>
	</div>
</div>

<!-- Actual Player -->
<div id="player"></div>
<script src="./bower_components/jquery/dist/jquery.min.js"></script>
<script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          videoId: 'blpl4swRxgQ',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
      	document.getElementById("meta-information").innerHTML = player.getVideoData().title;

      	//Display time
      	var duration = player.getDuration();
      	var minutes = Math.floor(duration / 60);
      	var seconds = duration - minutes * 60;
		var finalTime = str_pad_left(minutes,'0',2)+':'+str_pad_left(seconds,'0',2);
		document.getElementById("duration").innerHTML = finalTime;
        play();
        setInterval(function(){
            updateTime();
        }, 990);
      }

	function str_pad_left(string,pad,length) {
	    return (new Array(length+1).join(pad)+string).slice(-length);
	}

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
      	console.log("State changed");
        if (event.data == YT.PlayerState.PLAYING) {

        }
      }

      /**
       * If the video is playing pause it and else continue playing.
       */
      function changeVideoState() {
      	if(player.getPlayerState() == YT.PlayerState.PLAYING) {
      		pause();
      	} else {
      		play();
      	}
      	
      }

      function play() {
      	$("#play .icon").removeClass("fa-play");
      	$("#play .icon").addClass("fa-pause");
      	player.playVideo();
      }

      function pause() {
      	$("#play .icon").removeClass("fa-pause");
      	$("#play .icon").addClass("fa-play");
      	player.pauseVideo();
      }

      /**
       * Update the time in the GUI
       */
      function updateTime() {
      		var currentTime = Math.round(player.getCurrentTime());
	      	var minutes = Math.floor(currentTime / 60);
	      	var seconds = currentTime - minutes * 60;
			var currentTime = str_pad_left(minutes,'0',2)+':'+str_pad_left(seconds,'0',2);
			$("#time-elapsed").text(currentTime);
      }

      /**
       * Add Event Listeners for the GUI
       */
      $("#play").on("click", changeVideoState);


    </script>
</body>
</html>